(this.webpackJsonpbencoxfordapp=this.webpackJsonpbencoxfordapp||[]).push([[0],{183:function(e,t,a){},191:function(e,t){e.exports={endpoint:"https://databasebencoxford.documents.azure.com:443/",key:"DTAhh4DedQH2Pnyw5h5qCh2clQ2NPdGT7wntHqFfsVM2PVZK5owuG7ysikb8vYYYKv8AiGZ3DePMer3EQiWOKg==",databaseId:"outDatabase",containerId:"MyCollection"}},252:function(e,t,a){e.exports=a(550)},256:function(e,t,a){},550:function(e,t,a){"use strict";a.r(t);var r=a(7),n=a.n(r),i=a(41),o=a.n(i),s=a(129),l=a(20);a(256),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=a(0),d=a.n(c),h=a(118),u=a(3),p=a(6),m=a(13),v=a(14),g=(a(183),a(251)),b=a(184).CosmosClient,f=a(191),x=f.endpoint,y=f.key,E=f.databaseId,w=f.containerId,k=new b({endpoint:x,key:y}).database(E).container(w),D=new Date,C=new Date;C.setMinutes(C.getMinutes()-5),D.setHours(D.getHours()),C.setHours(C.getHours());var I=D.toISOString(),S={query:'SELECT * FROM c WHERE c.datetime BETWEEN "'+C.toISOString()+'" AND "'+I+'" ORDER BY c.datetime'},F=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).state={error:null,dataset:[]},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark((function e(){var t,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.items.query(S).fetchAll();case 3:t=e.sent,a=t.resources,r=[],a.forEach((function(e){r.push(e)})),this.setState({dataset:r}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.response);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"getDate",value:function(e){return e.substring(0,10)}},{key:"getTime",value:function(e){return e.substring(11,19)}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,r=t.dataset;return a?n.a.createElement("div",null,"Error"):void 0!==typeof r?n.a.createElement(g.a,{"table-responsive":!0,striped:!0,bordered:!0,hover:!0,variant:"light"},n.a.createElement("thead",{class:"thead-dark"},n.a.createElement("tr",null,n.a.createElement("th",{class:"border border-dark text-center font-weight-light"},"Device ID"),n.a.createElement("th",{class:"border border-dark text-center font-weight-light"},"Date"),n.a.createElement("th",{class:"border border-dark text-center font-weight-light"},"Time"),n.a.createElement("th",{class:"border border-dark text-center font-weight-light"},"Temperature"),n.a.createElement("th",{class:"border border-dark text-center font-weight-light"},"Humidity"),n.a.createElement("th",{class:"border border-dark text-center font-weight-light"},"Product Quantity"))),n.a.createElement("tbody",null,r.map((function(t){return n.a.createElement("tr",null,n.a.createElement("th",{class:"text-center font-weight-light"},t.deviceID),n.a.createElement("th",{class:"text-center font-weight-light"},e.getDate(t.datetime)),n.a.createElement("th",{class:"text-center font-weight-light"},e.getTime(t.datetime)," BST"),n.a.createElement("th",{class:"text-center font-weight-light"},t.temperature.toFixed(2),"\u2103"),n.a.createElement("th",{class:"text-center font-weight-light"},t.humidity.toFixed(2)),n.a.createElement("th",{class:"text-center font-weight-light"},t.productCount))})))):n.a.createElement("div",null,"Loading data...")}}]),a}(r.Component),A=a(101),R=a.n(A),T=(a(276),a(184).CosmosClient),O=a(191),L=O.endpoint,H=O.key,M=O.databaseId,j=O.containerId,q=new T({endpoint:L,key:H}).database(M).container(j),B={query:"SELECT c.deviceID, c.datetime, c.productCount FROM c"},N={query:"SELECT c.deviceID, c.datetime, c.humidity FROM c"},G={query:"SELECT c.deviceID, c.datetime, c.temperature FROM c"},P=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).chartA=n.a.createRef(),e.chartB=n.a.createRef(),e.chartC=n.a.createRef(),e.chartD=n.a.createRef(),e.state={error:null},e}return Object(p.a)(a,[{key:"getRandomInt",value:function(){return Math.floor(256*Math.random())}},{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark((function e(){var t,a,r,n,i,o,s,l,c,h,u,p,m,v,g,b,f,x,y,E,w,k,D,C,I,S,F,A;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.items.query(B).fetchAll();case 3:return t=e.sent,a=t.resources,e.next=7,q.items.query(N).fetchAll();case 7:return r=e.sent,n=r.resources,e.next=11,q.items.query(G).fetchAll();case 11:for(i=e.sent,o=i.resources,s=[],l=[],c=[],h=[],a.forEach((function(e){var t={x:new Date(e.datetime),y:e.productCount};s.push(t)})),u="rgb("+this.getRandomInt()+","+this.getRandomInt()+","+this.getRandomInt()+")",p=[{label:"All Stock",fill:!1,backgroundColor:u,borderColor:u,data:s}],a.forEach((function(e){var t={x:new Date(e.datetime),y:e.productCount};if(0===l.length){var a=[];a.push(t),l.push([e.deviceID,a])}else{for(var r=-1,n=0;n<l.length;n++)l[n][0]===e.deviceID&&(r=n);if(-1!==r)l[r][1].push(t);else{var i=[];i.push(t),l.push([e.deviceID,i])}}})),m=[],v=0;v<l.length;v++)g="rgb("+this.getRandomInt()+","+this.getRandomInt()+","+this.getRandomInt()+")",b={label:l[v][0],fill:!1,backgroundColor:g,borderColor:g,data:l[v][1]},m.push(b);for(o.forEach((function(e){var t={x:new Date(e.datetime),y:e.temperature.toFixed(2)};if(0===c.length){var a=[];a.push(t),c.push([e.deviceID,a])}else{for(var r=-1,n=0;n<c.length;n++)c[n][0]===e.deviceID&&(r=n);if(-1!==r)c[r][1].push(t);else{var i=[];i.push(t),c.push([e.deviceID,i])}}})),f=[],x=0;x<c.length;x++)y="rgb("+this.getRandomInt()+","+this.getRandomInt()+","+this.getRandomInt()+")",E={label:c[x][0],fill:!1,backgroundColor:y,borderColor:y,data:c[x][1]},f.push(E);for(n.forEach((function(e){var t={x:new Date(e.datetime),y:e.humidity.toFixed(2)};if(0===h.length){var a=[];a.push(t),h.push([e.deviceID,a])}else{for(var r=-1,n=0;n<h.length;n++)h[n][0]===e.deviceID&&(r=n);if(-1!==r)h[r][1].push(t);else{var i=[];i.push(t),h.push([e.deviceID,i])}}})),w=[],k=0;k<h.length;k++)D="rgb("+this.getRandomInt()+","+this.getRandomInt()+","+this.getRandomInt()+")",C={label:h[k][0],fill:!1,backgroundColor:D,borderColor:D,data:h[k][1]},w.push(C);I=this.chartA.current.getContext("2d"),new R.a(I,{type:"line",data:{datasets:p},options:{responsive:!0,scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"day",stepSize:1},scaleLabel:{display:!0,labelString:"Day"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Stock Levels (All Stock)"}}]},title:{display:!0,text:"Stock-Time Series Graph",fontColor:"black"}}}),S=this.chartB.current.getContext("2d"),new R.a(S,{type:"line",data:{datasets:m},options:{responsive:!0,scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"day",stepSize:1},scaleLabel:{display:!0,labelString:"Day"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Product Quantity (Individual)"}}]},title:{display:!0,text:"Product-Time Series Graph",fontColor:"black"}}}),F=this.chartC.current.getContext("2d"),new R.a(F,{type:"line",data:{datasets:f},options:{responsive:!0,scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"day",stepSize:1},scaleLabel:{display:!0,labelString:"Day"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Temeprature (C)"}}]},title:{display:!0,text:"Temperature-Time Series Graph",fontColor:"black"}}}),A=this.chartD.current.getContext("2d"),new R.a(A,{type:"line",data:{datasets:w},options:{responsive:!0,scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"day",stepSize:1},scaleLabel:{display:!0,labelString:"Day"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Humidity"}}]},title:{display:!0,text:"Humidity-Time Series Graph",fontColor:"black"}}}),e.next=42;break;case 39:e.prev=39,e.t0=e.catch(0),this.setState({error:e.t0.response});case 42:case"end":return e.stop()}}),e,this,[[0,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.a.createElement("div",{style:{display:"flex",flexFlow:"row wrap",justifyContent:"center",marginBottom:"5vh"}},n.a.createElement("div",{style:{float:"left",boxShadow:"5px 5px #1D2023",backgroundColor:"#F8F9FA",padding:"5px",border:"5px solid #F8F9FA",borderRadius:"5px",marginTop:"5vh",marginRight:"2.5vw",position:"relative",maxHeight:"50vh",width:"40vw"}},n.a.createElement("canvas",{ref:this.chartA})),n.a.createElement("div",{style:{float:"right",boxShadow:"5px 5px #1D2023",backgroundColor:"#F8F9FA",padding:"5px",border:"5px solid #F8F9FA",borderRadius:"5px",marginTop:"5vh",marginLeft:"2.5vw",position:"relative",maxHeight:"50vh",width:"40vw"}},n.a.createElement("canvas",{ref:this.chartB})),n.a.createElement("br",null),n.a.createElement("div",{style:{float:"left",boxShadow:"5px 5px #1D2023",backgroundColor:"#F8F9FA",padding:"5px",border:"5px solid #F8F9FA",borderRadius:"5px",marginTop:"5vh",marginRight:"2.5vw",position:"relative",maxHeight:"50vh",width:"40vw"}},n.a.createElement("canvas",{ref:this.chartC})),n.a.createElement("div",{style:{float:"right",boxShadow:"5px 5px #1D2023",backgroundColor:"#F8F9FA",padding:"5px",border:"5px solid #F8F9FA",borderRadius:"5px",marginTop:"5vh",marginLeft:"2.5vw",position:"relative",maxHeight:"50vh",width:"40vw"}},n.a.createElement("canvas",{ref:this.chartD})))}}]),a}(r.Component);function z(){return n.a.createElement(s.a,null,n.a.createElement("div",null,n.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},n.a.createElement("a",{className:"navbar-brand",href:"/"},"Ben Coxford IoT App"),n.a.createElement("div",{className:"collapse navbar-collapse"},n.a.createElement("div",{className:"navbar-nav"},n.a.createElement(s.b,{to:"/",className:"nav-item nav-link"},"Live"),n.a.createElement(s.b,{to:"/search",className:"nav-item nav-link"},"Analytics")))),n.a.createElement(l.a,{path:"/",exact:!0,component:F}),n.a.createElement(l.a,{path:"/search",component:P})))}var Q=document.getElementById("root");o.a.render(n.a.createElement(z,null),Q),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[252,1,2]]]);
//# sourceMappingURL=main.6412f794.chunk.js.map